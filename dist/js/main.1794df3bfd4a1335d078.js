!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}n.r(e);var r=function(){function t(){i(this,t)}return a(t,null,[{key:"rotate",value:function(t,e){var n=Math.cos(e),i=Math.sin(e);return[t[0]*n-t[1]*i,t[1]*n+t[0]*i]}},{key:"dot",value:function(t,e){return t[0]*e[0]+t[1]*e[1]}},{key:"cross",value:function(t,e){return t[0]*e[1]-t[1]*e[0]}},{key:"add",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"sub",value:function(t,e){return[t[0]-e[0],t[1]-e[1]]}},{key:"projection",value:function(e,n){var i=t.dot(e,n)/t.dot(n,n);return[n[0]*i,n[1]*i]}},{key:"length",value:function(e){return Math.sqrt(t.dot(e,e))}},{key:"scale",value:function(t,e){return[t[0]*e,t[1]*e]}},{key:"collisionCalc",value:function(e,n,i,o){return t.scale(t.add(t.scale(e,i-o),t.scale(n,2*o)),1/(i+o))}}]),t}();function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}var u=function(){function t(){s(this,t)}return c(t,null,[{key:"toPosRate",value:function(t,e,n){return[t[0]*(1-n)+e[0]*n,t[1]*(1-n)+e[1]*n]}},{key:"cross",value:function(t,e,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}},{key:"getCenter",value:function(t,e){return[.5*(t[0]+e[0]),.5*(t[1]+e[1])]}},{key:"getVector",value:function(t,e){return[e[0]-t[0],e[1]-t[1]]}},{key:"addVector",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"distance",value:function(e,n){return r.length(t.getVector(e,n))}}]),t}(),h=function(t,e,n,i){var o=u.distance(t,n);if(!(o<Math.abs(i-e))){var a=r.sub(n,t),s=Math.atan2(a[1],a[0]),l=Math.acos((e-i)/o),c=[Math.cos(s-l),Math.sin(s-l)],h=r.add(t,r.scale(c,e)),f=r.add(n,r.scale(c,i)),v=[Math.cos(s+l),Math.sin(s+l)];return[{p0:h,p1:f},{p0:r.add(t,r.scale(v,e)),p1:r.add(n,r.scale(v,i))}]}};function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}for(var p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"hsl(0,100%,50%)";f(this,t),this.options={pos:e,velocity:n,volume:i,z:o,zVelocity:a,color:r},this.init()}return d(t,[{key:"init",value:function(){this.maxVolume=this.options.volume,this.volume=this.maxVolume,this.prevPos=this.options.pos.slice(),this.pos=this.options.pos.slice(),this.velocity=this.options.velocity.slice(),this.z=this.options.z,this.zVelocity=this.options.zVelocity,this.swing=Math.random(),this.data=[]}},{key:"update",value:function(){this.prevVolume=this.volume,this.prevZ=this.z,this.prevPos[0]=this.pos[0],this.prevPos[1]=this.pos[1],this.pos[0]+=this.velocity[0],this.pos[1]+=this.velocity[1];var t=r.rotate([Math.sin(2*this.swing*Math.PI),0],Math.atan2(this.velocity[0],-this.velocity[1])),e=1-this.volume/this.maxVolume;this.velocity[0]+=e*t[0],this.velocity[1]+=e*t[1],this.z+=this.zVelocity,this.zVelocity-=.981,this.zVelocity*=.94,this.z<0&&(this.zVelocity*=-1,this.zVelocity*=.8,this.z=0),this.z<this.volume?(this.velocity[0]*=.8,this.velocity[1]*=.8,this.swing+=.1,this.swing%=1,this.volume>0&&(this.volume-=1.5+.2*Math.random())):(this.velocity[0]*=.94,this.velocity[1]*=.94,this.volume>0&&(this.volume-=.1))}},{key:"getR",value:function(){var t=this.volume-this.z;return t>1?t:1}},{key:"getPrevR",value:function(){var t=this.prevVolume-this.prevZ;return t>1?t:1}},{key:"render",value:function(t){if(!(this.volume<=0)&&this.z<this.volume){var e=this.getR(),n=this.getPrevR();t.fillStyle=this.options.color;var i=h(this.prevPos,n,this.pos,e);i?(t.beginPath(),t.moveTo(i[0].p0[0],i[0].p0[1]),t.lineTo(i[0].p1[0],i[0].p1[1]),t.lineTo(i[1].p1[0],i[1].p1[1]),t.lineTo(i[1].p0[0],i[1].p0[1]),t.fill(),t.beginPath(),t.arc(this.prevPos[0],this.prevPos[1],n,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(this.pos[0],this.pos[1],e,0,2*Math.PI),t.fill()):n>e?(t.beginPath(),t.arc(this.prevPos[0],this.prevPos[1],n,0,2*Math.PI),t.fill()):(t.beginPath(),t.arc(this.pos[0],this.pos[1],e,0,2*Math.PI),t.fill())}}}]),t}(),y=p,m=function(){return document.createElement("canvas").getContext("2d")},g=function(t,e,n,i,o){t.shadowColor=o,t.shadowBlur=i,t.shadowOffsetX=e,t.shadowOffsetY=n},P=new Array(200),M=0,b=P.length;M<b;M++)P[M]=1-2*Math.random();function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),t}var z=function(){function t(){w(this,t),this.particles=[],this.minPos=[1/0,1/0],this.maxPos=[-1/0,-1/0],this.prevMinPos=[1/0,1/0],this.prevMaxPos=[-1/0,-1/0]}return x(t,[{key:"splash",value:function(t,e,n,i){for(var o=Math.floor(.8*e),a=0;a<o;a++){var s=a/o*2*Math.PI+.1*(1-2*Math.random()),l=Math.min(.5*r.length(n),10),c=5+e*Math.random()-l,u=5+Math.min(Math.max(2*Math.random()+100/c,0),35),h=[Math.cos(s),Math.sin(s)];this.particles.push(new y(r.add(t,r.scale(h,.25*e)),r.add(r.scale(h,u),n),c,3+7*Math.random()+l*Math.random(),10/c,i))}this.calcRect()}},{key:"calcRect",value:function(){var t=this;this.prevMinPos=this.minPos.slice(),this.prevMaxPos=this.maxPos.slice(),this.particles.forEach((function(e,n,i){var o=e.getR(),a=e.pos;a[0]-o<t.minPos[0]&&(t.minPos[0]=a[0]-o),a[1]-o<t.minPos[1]&&(t.minPos[1]=a[1]-o),a[0]+o>t.maxPos[0]&&(t.maxPos[0]=a[0]+o),a[1]+o>t.maxPos[1]&&(t.maxPos[1]=a[1]+o)}))}},{key:"update",value:function(){this.particles.forEach((function(t,e,n){t.update(),t.volume<=0&&n.splice(e,1)})),this.calcRect()}},{key:"render",value:function(t){this.particles.length&&(t.save(),this.particles.forEach((function(e){return e.render(t)})),t.restore())}}]),t}(),E=z;var V,O,T,S=document.getElementById("canvas"),j=S.getContext("2d"),C=m(),I=m(),R=[0,0],L=20,A=!0,B=R.slice(),_=!1,X=[],Y=0,q=Date.now(),D=function(t){if(!_){var e=t.touches?t.touches[0]:t;R[0]=e.pageX,R[1]=e.pageY,_=!0,L=20,T="hsla(".concat(360*Math.random(),",100%,50%)"),A=!1}},F=function(t){if(_){var e=t.touches?t.touches[0]:t;R[0]=e.pageX,R[1]=e.pageY}},N=function(){if(_){_=!1;var t=r.sub(R,B),e=Math.atan2(t[1],t[0]),n=r.scale([Math.cos(e),Math.sin(e)],Math.min(r.length(t),40)),i=new E;i.splash(R,L,n,T),X.push(i)}},Z=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};Z()?(S.addEventListener("touchstart",D),S.addEventListener("touchmove",F),S.addEventListener("touchend",N)):(S.addEventListener("mousedown",D),S.addEventListener("mousemove",F),S.addEventListener("mouseup",N)),window.addEventListener("resize",(function(){H()}));var H=function(){V=j.canvas.width=C.canvas.width=I.canvas.width=window.innerWidth,O=j.canvas.height=C.canvas.height=I.canvas.height=window.innerHeight,W()},W=function(){B=R.slice(),X.forEach((function(t){return t.update()}))},G=function(){X.forEach((function(t){return t.render(C)})),I.clearRect(0,0,V,O),_&&(I.save(),g(I,0,0,10,"rgba(0,0,0,0.5)"),L++,L=Math.min(L,40),I.fillStyle=T,I.beginPath(),I.arc(R[0],R[1],L,0,2*Math.PI,!0),I.fill(),I.restore()),A&&(I.save(),I.font="bold 32px Noto Sans TC",I.textAlign="center",I.textBaseline="hanging",I.fillStyle="#f0f0f0",I.fillText("滑鼠按住集氣油漆，放開的瞬間移動方向可改變潑灑方位。",.5*V,.5*O),I.restore()),I.save(),I.font="bold 18px Noto Sans TC",I.textAlign="start",I.textBaseline="hanging",I.fillStyle="#ff0000",I.fillText(Y.toFixed(1),10,10),I.restore(),j.fillStyle="#000000",j.fillRect(0,0,V,O),j.drawImage(C.canvas,0,0),j.drawImage(I.canvas,0,0)},J=function t(){requestAnimationFrame(t);var e=Date.now(),n=(e-q)/1e3;q=e,Y=1/n,W(),G()};H(),J()}]);